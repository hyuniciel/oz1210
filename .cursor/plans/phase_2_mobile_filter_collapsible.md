# Phase 2: 필터 섹션 접기/펼치기 기능 (모바일) 구현 계획

## 목표
모바일 환경에서 필터 섹션을 접기/펼치기할 수 있도록 하여 화면 공간을 효율적으로 활용하고 사용자 경험을 개선합니다.

## 현재 상태
- ✅ 필터 컴포넌트 반응형 디자인 적용 (모바일: flex-col, 데스크톱: flex-row)
- ✅ 모바일에서 필터가 세로로 배치됨
- ❌ 모바일에서 필터 섹션 접기/펼치기 기능 없음
- ❌ Collapsible 컴포넌트 미설치

## 구현 항목

### 1. Collapsible 컴포넌트 설치

#### 목표
shadcn/ui의 Collapsible 컴포넌트를 설치하여 접기/펼치기 기능을 구현합니다.

#### 구현 내용
- `pnpx shadcn@latest add collapsible` 명령어 실행
- `components/ui/collapsible.tsx` 파일 생성 확인
- Collapsible 컴포넌트 import 경로 확인

### 2. 필터 컴포넌트 구조 변경

#### 목표
모바일에서만 Collapsible을 적용하고, 데스크톱에서는 항상 펼쳐진 상태로 유지합니다.

#### 구현 내용

**2.1 상태 관리 추가**
- `useState`로 `isMobileFilterOpen` 상태 추가
- 기본값: `false` (모바일에서 접힘)
- 데스크톱에서는 항상 `true`로 유지 (CSS 미디어 쿼리 또는 useEffect로 감지)

**2.2 모바일/데스크톱 감지**
- 방법 1: `useEffect`와 `window.matchMedia` 사용
  - `(min-width: 768px)` 브레이크포인트 사용 (md 브레이크포인트)
  - 데스크톱 감지 시 `isMobileFilterOpen`을 `true`로 설정
  - 리사이즈 이벤트 리스너 추가
- 방법 2: CSS 클래스 기반 접근
  - 데스크톱에서는 Collapsible을 우회하고 항상 표시
  - 모바일에서만 Collapsible 적용

**2.3 컴포넌트 구조 변경**
- 전체 필터 컨테이너를 `Collapsible`로 감싸기
- `CollapsibleTrigger`: 토글 버튼 (모바일에서만 표시)
- `CollapsibleContent`: 필터 컨텐츠 (접기/펼치기 대상)

### 3. 토글 버튼 UI 구현

#### 목표
사용자가 필터 섹션을 쉽게 접기/펼치기할 수 있는 직관적인 버튼을 제공합니다.

#### 구현 내용

**3.1 토글 버튼 디자인**
- 버튼 위치: 필터 섹션 상단 (모바일에서만 표시)
- 버튼 스타일: 전체 너비, 배경색, 테두리, 패딩
- 아이콘: `ChevronDown` (lucide-react)
  - 접힘 상태: 아래 방향 화살표
  - 펼침 상태: 위 방향 화살표 (회전)
- 레이블: "필터" 텍스트 + 활성 필터 개수 (선택 사항)

**3.2 버튼 레이아웃**
- 왼쪽: 필터 아이콘 + "필터" 텍스트
- 오른쪽: ChevronDown 아이콘 (회전 애니메이션)
- 중앙: 활성 필터 개수 표시 (선택 사항)

**3.3 접근성 개선**
- `aria-label`: "필터 접기/펼치기"
- `aria-expanded`: 접기/펼치기 상태
- 키보드 네비게이션 지원 (Enter, Space)

### 4. 애니메이션 및 전환 효과

#### 목표
접기/펼치기 시 부드러운 애니메이션을 제공하여 사용자 경험을 향상시킵니다.

#### 구현 내용

**4.1 Collapsible 애니메이션**
- shadcn/ui Collapsible 컴포넌트의 기본 애니메이션 활용
- 높이 전환 애니메이션 (기본 제공)
- 페이드 인/아웃 효과 (선택 사항)

**4.2 아이콘 회전 애니메이션**
- ChevronDown 아이콘 회전 효과
- `transform: rotate(180deg)` (펼침 상태)
- `transition-transform` 적용

**4.3 전환 시간**
- 기본 전환 시간: 200-300ms
- `transition-all duration-300` 클래스 사용

### 5. 활성 필터 개수 표시 (선택 사항)

#### 목표
사용자가 현재 적용된 필터 개수를 한눈에 확인할 수 있도록 합니다.

#### 구현 내용

**5.1 활성 필터 계산**
- 기본 필터 값과 다른 필터만 카운트
- 지역 필터: 기본값("1")과 다르면 카운트
- 관광 타입 필터: 선택되면 카운트
- 정렬 필터: 기본값("latest")과 다르면 카운트
- 반려동물 필터: 활성화되면 카운트

**5.2 뱃지 표시**
- 토글 버튼에 작은 뱃지 표시
- 예: "필터 (3)" 형식
- 활성 필터가 없으면 뱃지 숨김

### 6. 반응형 동작

#### 목표
화면 크기에 따라 자동으로 접기/펼치기 상태를 조정합니다.

#### 구현 내용

**6.1 데스크톱 동작**
- 화면 너비 >= 768px (md 브레이크포인트)
- 항상 펼쳐진 상태 유지
- 토글 버튼 숨김
- Collapsible 기능 비활성화

**6.2 모바일 동작**
- 화면 너비 < 768px
- 기본 상태: 접힘
- 토글 버튼 표시
- Collapsible 기능 활성화

**6.3 화면 크기 변경 감지**
- `window.matchMedia` 리스너 추가
- 화면 크기 변경 시 상태 업데이트
- 컴포넌트 언마운트 시 리스너 제거

## 구현 순서

1. **Collapsible 컴포넌트 설치**
   - shadcn/ui Collapsible 설치
   - 컴포넌트 파일 확인

2. **필터 컴포넌트 구조 변경**
   - Collapsible로 필터 컨테이너 감싸기
   - 상태 관리 추가 (isMobileFilterOpen)
   - 모바일/데스크톱 감지 로직 구현

3. **토글 버튼 UI 구현**
   - 토글 버튼 디자인 및 레이아웃
   - 아이콘 및 레이블 추가
   - 접근성 속성 추가

4. **애니메이션 적용**
   - Collapsible 애니메이션 확인
   - 아이콘 회전 애니메이션 추가
   - 전환 효과 조정

5. **활성 필터 개수 표시 (선택 사항)**
   - 활성 필터 계산 로직
   - 뱃지 UI 추가

6. **반응형 동작 구현**
   - 데스크톱에서 항상 펼침
   - 모바일에서 접기/펼치기
   - 화면 크기 변경 감지

7. **테스트 및 검증**
   - 모바일 환경에서 접기/펼치기 테스트
   - 데스크톱 환경에서 항상 펼침 확인
   - 화면 크기 변경 시 동작 확인
   - 접근성 테스트

## 구현 파일

### 수정할 파일
- `components/tour-filters.tsx`: Collapsible 적용, 상태 관리, 토글 버튼 추가

### 새로 설치할 컴포넌트
- `components/ui/collapsible.tsx`: shadcn/ui Collapsible 컴포넌트

## 참고사항

- 모바일 브레이크포인트: 768px (Tailwind CSS `md` 브레이크포인트)
- 기본 상태: 모바일에서 접힘, 데스크톱에서 펼침
- 필터 상태는 URL 파라미터로 관리되므로 접기/펼치기 상태는 로컬 상태로 관리
- Collapsible 컴포넌트는 Radix UI 기반으로 접근성이 내장되어 있음
- 애니메이션은 성능을 고려하여 CSS transition 사용

## 예상 UI 구조

```
모바일 (접힘 상태):
┌─────────────────────────┐
│ [필터 ▼]                │  ← 토글 버튼
└─────────────────────────┘

모바일 (펼침 상태):
┌─────────────────────────┐
│ [필터 ▲]                │  ← 토글 버튼
├─────────────────────────┤
│ 지역 필터               │
│ 관광 타입 필터          │
│ 정렬 옵션               │
│ 반려동물 필터           │
│ [리셋]                  │
└─────────────────────────┘

데스크톱 (항상 펼침):
┌─────────────────────────────────────────────┐
│ 지역 │ 관광 타입 │ 정렬 │ 반려동물 │ [리셋] │
└─────────────────────────────────────────────┘
```

